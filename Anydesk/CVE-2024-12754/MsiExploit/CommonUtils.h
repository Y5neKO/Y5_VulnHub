#pragma once

#include <Windows.h>
#include <string>

typedef void(__stdcall *console_output)(const char*);

bool DeleteDirectoryContents(LPWSTR dirPath);
bool RemoveDirectoryWithContents(LPWSTR dirPath);
std::wstring s2ws(const std::string& str);
bool DoesFileExist(LPCWSTR lpszFilename);
bool dirExists(LPCWSTR dirName_in);
HANDLE CreateSymlink(HANDLE root, LPCWSTR linkname, LPCWSTR targetname);
std::wstring StringToWString(const std::string& s);
std::string WStringToString(const std::wstring& s);
void DebugSetOutput(console_output pout);
void DebugPrintf(const char* lpFormat, ...);
HANDLE CreateSymlink(HANDLE root, LPCWSTR linkname, LPCWSTR targetname);
int main(int argc, const char* argv[]);
HANDLE OpenSymlink(HANDLE root, LPCWSTR linkname);
HANDLE CreateObjectDirectory(HANDLE hRoot, LPCWSTR dirname, HANDLE hShadow);
HANDLE OpenObjectDirectory(HANDLE hRoot, LPCWSTR dirname);
std::wstring GetErrorMessage(DWORD dwError);
std::wstring GetErrorMessage();
BOOL SetPrivilege(HANDLE hToken, LPCTSTR lpszPrivilege, BOOL bEnablePrivilege);
bool CreateRegSymlink(LPCWSTR lpSymlink, LPCWSTR lpTarget, bool bVolatile);
bool DeleteRegSymlink(LPCWSTR lpSymlink);
DWORD NtStatusToDosError(NTSTATUS status);
bool CreateNativeHardlink(LPCWSTR linkname, LPCWSTR targetname);
bool CreateNativeHardlink(LPCWSTR targetname, HANDLE hFile);
HANDLE OpenFileNative(LPCWSTR path, HANDLE root, ACCESS_MASK desired_access, ULONG share_access, ULONG open_options);
std::wstring BuildFullPath(const std::wstring& path, bool native);
std::wstring GetFileName(const std::wstring& s);
std::wstring GetDirectoryName(const std::wstring& filename);